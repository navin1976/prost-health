---
import BaseLayout from '../components/layout/BaseLayout.astro';
import RiskVisualization from '../components/RiskVisualization.astro';
import { TAGLINE, PRIMARY_MESSAGE, SECONDARY_MESSAGE, TRUST_SIGNALS } from '../lib/constants';
---

<BaseLayout>
  <!-- Theme & Font Controls -->
  <div class="design-controls">
    <!-- Color Theme Toggle -->
    <div class="theme-toggle">
      <span class="control-label">Color:</span>
      <button id="theme-green" class="theme-circle active" data-color="#1B4332" aria-label="Racing Green" title="Racing Green"></button>
      <button id="theme-cobalt" class="theme-circle" data-color="#1e40af" aria-label="Cobalt Blue" title="Cobalt Blue"></button>
      <button id="theme-amber" class="theme-circle" data-color="#d97706" aria-label="Amber" title="Amber"></button>
      <button id="theme-professional-purple" class="theme-circle" data-color="#7c3aed" aria-label="Professional Purple" title="Professional Purple"></button>
      <button id="theme-black-white" class="theme-circle" data-color="#000000" aria-label="Black & White" title="Black & White"></button>
    </div>
    
    <!-- Font Toggle -->
    <div class="font-toggle">
      <span class="control-label">Font:</span>
      <button id="font-serif" class="font-btn active" data-font="serif" title="Playfair Display">Aa</button>
      <button id="font-calsans" class="font-btn" data-font="calsans" title="Cal Sans">Aa</button>
      <button id="font-inter" class="font-btn" data-font="inter" title="Inter">Aa</button>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero-section scroll-animate">
    <!-- Large Hero Image -->
    <div class="hero-image-container scroll-animate">
      <img 
        src="/images/alex-kirkham.jpg" 
        alt="Alex Kirkham reporting - Expert Uroradiologist"
        loading="eager"
        decoding="async"
      />
      <!-- Overlay -->
      <div class="hero-overlay"></div>
    </div>
    
    <!-- Hero Content -->
    <div class="hero-content container mx-auto px-6">
      <div class="max-w-2xl text-left space-y-6">
        <h1 class="text-5xl md:text-7xl font-serif font-bold leading-tight text-white" style="color: white !important;">
          {TAGLINE}
        </h1>
        <p class="text-xl md:text-2xl font-medium text-white">
          {PRIMARY_MESSAGE}
        </p>
        <p class="text-lg text-gray-100">
          {SECONDARY_MESSAGE}
        </p>
        <div class="flex flex-col sm:flex-row gap-4 pt-8">
          <a
            href="/our-approach"
            class="px-8 py-4 bg-accent text-white rounded-md bg-accent-hover transition-colors font-semibold text-lg"
          >
            Discover Our Approach
          </a>
          <a
            href="/contact"
            class="px-8 py-4 border-2 border-white text-white rounded-md hover:bg-white hover:text-black transition-colors font-semibold text-lg"
          >
            Speak with a Coordinator
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Trust Bar -->
  <section class="bg-[--color-white] py-8 border-y border-[--color-light-gray] scroll-animate">
    <div class="container mx-auto px-6">
      <div class="flex flex-col md:flex-row justify-center items-center gap-8 md:gap-16 text-center scroll-stagger">
        {TRUST_SIGNALS.map((signal) => (
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
              <path
                fill-rule="evenodd"
                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                clip-rule="evenodd"
              />
            </svg>
            <span class="text-sm font-medium text-black">{signal}</span>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Problem/Solution Section -->
  <section class="py-20 md:py-32 bg-[--color-off-white]">
    <div class="container mx-auto px-6">
      <div class="text-center mb-16 scroll-animate">
        <h2 class="text-4xl md:text-5xl font-serif font-bold text-[--color-black] mb-6 scroll-animate-heading">
          Two Paths, One Clear Choice
        </h2>
        <p class="text-xl text-[--color-gray] max-w-3xl mx-auto scroll-animate-text">
          Compare the traditional approach with our MRI-first method. See the difference in accuracy, 
          safety, and peace of mind.
        </p>
      </div>

      <!-- Interactive Risk Visualization -->
      <div class="mb-16">
        <RiskVisualization />
      </div>

      <div class="grid md:grid-cols-2 gap-12 max-w-6xl mx-auto scroll-cards">
        <!-- The Old Way -->
        <div class="space-y-6 bg-[--color-white] p-8 rounded-lg border border-[--color-light-gray] scroll-card-left">
          <h2 class="text-3xl md:text-4xl font-serif font-bold text-[--color-black]">
            Uncertainty and Invasion.
          </h2>
          <p class="text-[--color-gray] leading-relaxed">
            Traditional prostate cancer screening relies on blind biopsies—invasive procedures that carry 
            significant risks including infection, bleeding, and long-lasting urinary or sexual problems. 
            These biopsies can miss cancers, over-diagnose insignificant ones, and leave men in a state 
            of uncertainty.
          </p>
          <ul class="space-y-3">
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-[#E50914] mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-[--color-black]">Risk of infection and complications</span>
            </li>
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-[#E50914] mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-[--color-black]">Potential for missed cancers</span>
            </li>
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-[#E50914] mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-[--color-black]">Over-diagnosis of insignificant findings</span>
            </li>
          </ul>
        </div>

        <!-- The Prost Health Way -->
        <div class="space-y-6 bg-[--color-white] p-8 rounded-lg border border-[--color-light-gray] scroll-card-right">
          <h2 class="text-3xl md:text-4xl font-serif font-bold text-[--color-black]">
            Precision and Peace of Mind.
          </h2>
          <p class="text-[--color-gray] leading-relaxed">
            Our MRI-first approach provides high-resolution imaging that allows our expert radiologists 
            to see exactly what's happening before any invasive procedure. This means accurate diagnosis, 
            fewer unnecessary biopsies, and definitive answers that give you clarity and control.
          </p>
          <ul class="space-y-3">
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-accent mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-black">Non-invasive, no recovery time needed</span>
            </li>
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-accent mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-black">96% accuracy in ruling out aggressive cancer</span>
            </li>
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-accent mt-1 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path
                  fill-rule="evenodd"
                  d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                  clip-rule="evenodd"
                />
              </svg>
              <span class="text-black">Helps avoid unnecessary biopsies and treatment</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-[--color-black] text-white py-20 scroll-animate">
    <div class="container mx-auto px-6 text-center scroll-animate-cta">
      <h2 class="text-3xl md:text-5xl font-serif font-bold mb-6">
        Ready to Take Control of Your Prostate Health?
      </h2>
      <p class="text-xl text-[--color-light-gray] mb-8 max-w-2xl mx-auto">
        Learn more about our MRI-first approach and how it can provide you with the clarity you deserve.
      </p>
      <a
        href="/our-approach"
        class="inline-block px-8 py-4 bg-accent text-white rounded-md bg-accent-hover transition-colors font-semibold text-lg"
      >
        Discover Our Approach
      </a>
    </div>
  </section>

  <!-- Design Controls Script -->
  <script>
    // Color Theme Buttons
    const themeButtons = {
      'theme-green': 'green',
      'theme-cobalt': 'cobalt',
      'theme-amber': 'amber',
      'theme-professional-purple': 'professional-purple',
      'theme-black-white': 'black-white'
    };
    
    // Font Theme Buttons
    const fontButtons = {
      'font-serif': 'serif',
      'font-calsans': 'calsans',
      'font-inter': 'inter'
    };
    
    // Load saved preferences
    const savedTheme = localStorage.getItem('theme') || 'green';
    const savedFont = localStorage.getItem('font') || 'serif';
    
    // Set active color theme on load
    Object.keys(themeButtons).forEach(buttonId => {
      const button = document.getElementById(buttonId);
      const themeName = themeButtons[buttonId];
      
      if (themeName === savedTheme) {
        button?.classList.add('active');
        if (themeName !== 'green') {
          document.documentElement.setAttribute('data-theme', themeName);
        }
      } else {
        button?.classList.remove('active');
      }
    });
    
    // Set active font theme on load
    Object.keys(fontButtons).forEach(buttonId => {
      const button = document.getElementById(buttonId);
      const fontName = fontButtons[buttonId];
      
      if (fontName === savedFont) {
        button?.classList.add('active');
        if (fontName !== 'serif') {
          document.documentElement.setAttribute('data-font', fontName);
        }
      } else {
        button?.classList.remove('active');
      }
    });
    
    // Add click handlers to color theme buttons
    Object.keys(themeButtons).forEach(buttonId => {
      const button = document.getElementById(buttonId);
      const themeName = themeButtons[buttonId];
      
      button?.addEventListener('click', () => {
        // Remove all themes
        document.documentElement.removeAttribute('data-theme');
        
        // Set new theme if not default green
        if (themeName !== 'green') {
          document.documentElement.setAttribute('data-theme', themeName);
        }
        
        // Update active states
        Object.keys(themeButtons).forEach(otherButtonId => {
          document.getElementById(otherButtonId)?.classList.remove('active');
        });
        button.classList.add('active');
        
        // Save preference
        localStorage.setItem('theme', themeName);
      });
    });
    
    // Add click handlers to font buttons
    Object.keys(fontButtons).forEach(buttonId => {
      const button = document.getElementById(buttonId);
      const fontName = fontButtons[buttonId];
      
      button?.addEventListener('click', () => {
        // Remove all font themes
        document.documentElement.removeAttribute('data-font');
        
        // Set new font if not default serif
        if (fontName !== 'serif') {
          document.documentElement.setAttribute('data-font', fontName);
        }
        
        // Update active states
        Object.keys(fontButtons).forEach(otherButtonId => {
          document.getElementById(otherButtonId)?.classList.remove('active');
        });
        button.classList.add('active');
        
        // Save preference
        localStorage.setItem('font', fontName);
      });
    });
  </script>

  <!-- Scroll Animations Script - Dramatic & Reversible -->
  <script>
    import anime from 'animejs';

    // Wait for DOM to be ready
    document.addEventListener('DOMContentLoaded', () => {
      // Animation state tracking
      const animatedElements = new Map();

      // Intersection Observer for bidirectional scroll animations
      const observerOptions = {
        threshold: 0.1, // Lower threshold - trigger earlier when 10% visible
        rootMargin: '100px 0px 100px 0px' // Add margin to prevent flickering at screen edges
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const element = entry.target;
          const isInView = entry.isIntersecting;
          
          // Animate in when entering viewport
          if (isInView) {
            animateIn(element);
          } 
          // Animate out when leaving viewport
          else {
            animateOut(element);
          }
        });
      }, observerOptions);

      // Dramatic ENTRANCE animations
      function animateIn(element) {
        if (element.classList.contains('scroll-animate-viz')) {
          // Entire visualization container - 50% reduced
          anime({
            targets: element,
            opacity: [0, 1],
            scale: [0.95, 1],
            translateY: [30, 0], // 60 → 30
            duration: 1000,
            easing: 'easeOutExpo'
          });
        } else if (element.classList.contains('scroll-animate-header')) {
          // Visualization header - 50% reduced
          anime({
            targets: element,
            opacity: [0, 1],
            translateY: [25, 0], // 50 → 25
            duration: 800,
            easing: 'easeOutExpo'
          });
        } else if (element.classList.contains('scroll-animate-toggle')) {
          // Method toggle buttons - 50% reduced
          anime({
            targets: element,
            opacity: [0, 1],
            scale: [0.9, 1], // 0.8 → 0.9
            rotateY: [45, 0], // 90 → 45
            duration: 900,
            easing: 'easeOutExpo',
            delay: 200
          });
        } else if (element.classList.contains('scroll-viz-card')) {
          // Individual metric cards - 50% reduced
          const cards = document.querySelectorAll('.scroll-viz-card');
          const index = Array.from(cards).indexOf(element);
          anime({
            targets: element,
            opacity: [0, 1],
            translateY: [40, 0], // 80 → 40
            scale: [0.925, 1], // 0.85 → 0.925
            rotateX: [10, 0], // 20 → 10
            duration: 900,
            easing: 'easeOutExpo',
            delay: index * 150
          });
        } else if (element.classList.contains('scroll-animate-summary')) {
          // Clinical summary footer - 50% reduced
          anime({
            targets: element,
            opacity: [0, 1],
            translateY: [35, 0], // 70 → 35
            scale: [0.95, 1], // 0.9 → 0.95
            duration: 900,
            easing: 'easeOutExpo',
            delay: 300
          });
        } else if (element.classList.contains('scroll-animate-heading')) {
          anime({
            targets: element,
            opacity: [0, 1],
            translateY: [40, 0], // 80 → 40
            scale: [0.9, 1], // 0.8 → 0.9
            rotate: [-2.5, 0], // -5 → -2.5
            duration: 1000,
            easing: 'easeOutExpo'
          });
        } else if (element.classList.contains('scroll-card-left')) {
          anime({
            targets: element,
            opacity: [0, 1],
            translateX: [-75, 0], // -150 → -75
            rotateY: [-10, 0], // -20 → -10
            duration: 900,
            easing: 'easeOutExpo',
            delay: 100
          });
        } else if (element.classList.contains('scroll-card-right')) {
          anime({
            targets: element,
            opacity: [0, 1],
            translateX: [75, 0], // 150 → 75
            rotateY: [10, 0], // 20 → 10
            duration: 900,
            easing: 'easeOutExpo',
            delay: 200
          });
        } else if (element.classList.contains('scroll-stagger')) {
          anime({
            targets: element.children,
            opacity: [0, 1],
            translateY: [30, 0], // 60 → 30
            scale: [0.85, 1], // 0.7 → 0.85
            duration: 700,
            delay: anime.stagger(150),
            easing: 'easeOutExpo'
          });
        } else if (element.classList.contains('scroll-animate')) {
          anime({
            targets: element,
            opacity: [0, 1],
            translateY: [50, 0], // 100 → 50
            scale: [0.925, 1], // 0.85 → 0.925
            duration: 1000,
            easing: 'easeOutExpo'
          });
        }
      }

      // Dramatic EXIT animations (reverse)
      function animateOut(element) {
        if (element.classList.contains('scroll-animate-viz')) {
          anime({
            targets: element,
            opacity: [1, 0],
            scale: [1, 0.95],
            translateY: [0, 30], // 60 → 30
            duration: 800,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-animate-header')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateY: [0, -25], // -50 → -25
            duration: 700,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-animate-toggle')) {
          anime({
            targets: element,
            opacity: [1, 0],
            scale: [1, 0.9], // 0.8 → 0.9
            rotateY: [0, -45], // -90 → -45
            duration: 700,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-viz-card')) {
          const cards = document.querySelectorAll('.scroll-viz-card');
          const index = Array.from(cards).indexOf(element);
          anime({
            targets: element,
            opacity: [1, 0],
            translateY: [0, -40], // -80 → -40
            scale: [1, 0.925], // 0.85 → 0.925
            rotateX: [0, -10], // -20 → -10
            duration: 700,
            easing: 'easeInExpo',
            delay: (cards.length - 1 - index) * 100
          });
        } else if (element.classList.contains('scroll-animate-summary')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateY: [0, 35], // 70 → 35
            scale: [1, 0.95], // 0.9 → 0.95
            duration: 700,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-animate-heading')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateY: [0, -40], // -80 → -40
            scale: [1, 0.9], // 0.8 → 0.9
            rotate: [0, 2.5], // 5 → 2.5
            duration: 800,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-card-left')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateX: [0, -75], // -150 → -75
            rotateY: [0, -10], // -20 → -10
            duration: 800,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-card-right')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateX: [0, 75], // 150 → 75
            rotateY: [0, 10], // 20 → 10
            duration: 800,
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-stagger')) {
          anime({
            targets: element.children,
            opacity: [1, 0],
            translateY: [0, 30], // 60 → 30
            scale: [1, 0.85], // 0.7 → 0.85
            duration: 600,
            delay: anime.stagger(80, {from: 'last'}),
            easing: 'easeInExpo'
          });
        } else if (element.classList.contains('scroll-animate')) {
          anime({
            targets: element,
            opacity: [1, 0],
            translateY: [0, 50], // 100 → 50
            scale: [1, 0.925], // 0.85 → 0.925
            duration: 800,
            easing: 'easeInExpo'
          });
        }
      }

      // Observe all scroll-animated elements
      document.querySelectorAll(
        '.scroll-animate, .scroll-animate-heading, .scroll-animate-text, .scroll-card-left, .scroll-card-right, .scroll-stagger, .scroll-animate-viz, .scroll-animate-header, .scroll-animate-toggle, .scroll-viz-card, .scroll-animate-summary'
      ).forEach(el => {
        observer.observe(el);
      });
    });
  </script>
</BaseLayout>
